% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ems_model.R
\name{ems_model}
\alias{ems_model}
\title{Load general model specifications}
\usage{
ems_model(model_input, closure_file, var_omit = NULL, ...)
}
\arguments{
\item{model_input}{Input containing the model. The model input
can be selected from vetted internal models or provided by
the user.
\itemize{
\item Internal model: an exported data object corresponding to an
internally available model
\item User-provided model: Character vector of length 1, file
name in working directory or path to a .tab file.
}

See
\href{https://github.com/teems-org/teems-models}{teems-models}
for internally available model inputs and compatible Tablo
file formatting.}

\item{closure_file}{A character of length 1 (default is
\code{NULL}). File name in working directory or path to a ".cls"
closure file. See
\href{https://github.com/teems-org/teems-models}{teems-models}
for formatting of closure files.}

\item{var_omit}{A character vector (default is \code{NULL}).
Variables that to be substituted with \code{0} within the Tablo
model file and removed from the designated closure (if
present).}

\item{...}{A named pairlist assigning aggregation-specific
values to model coefficients. The LHS must correspond to a
model coefficient declared within \code{"model_input"}. The RHS
is the value to be assigned and may be either a numeric
length 1, a data frame or data frame extension (e..g,
tibble, data table), or path to a CSV file.

If a numeric length 1 is provided to a non-binary
coefficient or coefficient with a set affiliation, all set
combinations will be assigned this uniform value. Data frame
equivalent and CSV inputs must contain all set
aggregation-specific elements to be replaced (with sets as
columns) as well as a "Value" column with new values. This
replacement will be subject to structure checks according to
set aggregations specified in \code{\link[=ems_data]{ems_data()}}.

Note that set names must be provided as the model-specific
concatenation of the standard set name plus the
variable-specific index. For example, the standard set name
"REG" with subindex "r" would be "REGr".}
}
\value{
A tibble with attributes containing the parsed model
input for use within the \code{"model"} argument of
\code{\link[=ems_deploy]{ems_deploy()}}.
}
\description{
\code{ems_model} is a generic function that loads
general model specifications, conducts pre-pipeline checks,
and determines temporal dynamics. The output of this
function is a required input to the \code{"model"} argument of
the \code{\link[=ems_deploy]{ems_deploy()}} function.
}
\examples{
temp_dir <- tools::R_user_dir(package = "teems", "data")
if (!dir.exists(temp_dir)) {
  dir.create(temp_dir)
}
file.copy(c(teems_example(path = "GTAP_RE.tab"),
            teems_example(path = "GTAP_RE.cls"),
            teems_example(path = "GTAPv7.tab"),
            teems_example(path = "GTAPv7.cls")),
          temp_dir)

# simple model load
model <- ems_model(model_input = file.path(temp_dir, "GTAPv7.tab"),
                   closure_file = file.path(temp_dir, "GTAPv7.cls"))

# model load with variable omission and uniformly applied value to
# KAPPA coefficient and heterogeneous values allocated to SUBPAR
COMMc <- c("crops", "food", "livestock", "mnfcs", "svces")
REGr <- c("usa", "chn", "row")
ALLTIMEt <- seq_len(5)

SUBPAR <- expand.grid(COMMc = COMMc,
                      REGr = REGr,
                      ALLTIMEt = ALLTIMEt)
SUBPAR$Value <- runif(nrow(SUBPAR))
model <- ems_model(model_input = file.path(temp_dir, "GTAP_RE.tab"),
                   closure_file = file.path(temp_dir, "GTAP_RE.cls"),
                   var_omit = c("atall", "avaall", "tfe", "tfm", "tgd", "tgm", "tid", "tim"),
                   KAPPA = 0.03,
                   SUBPAR = SUBPAR)
unlink(temp_dir)
}
\seealso{
\code{\link[=ems_deploy]{ems_deploy()}} for loading the output of this
function as well as conducting any closure swaps.
}
